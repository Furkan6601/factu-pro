<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>FactuPro ‚Äî Factures</title>
<link rel="icon" href="favicon.ico">
<style>
:root{ --brand1:#0ea5e9; --brand2:#6366f1; --bg:#f6f8fb; --text:#0f172a; }
*{box-sizing:border-box} html,body{margin:0;padding:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--text)}
a{color:var(--brand2);text-decoration:none}
.container{max-width:1100px;margin:0 auto;padding:20px}
header{background:linear-gradient( to right, rgba(14,165,233,.15), rgba(99,102,241,.15));border-bottom:1px solid #e2e8f0}
nav{display:flex;align-items:center;gap:16px;justify-content:space-between}
.brand{display:flex;align-items:center;gap:12px}
.brand img{width:42px;height:42px;border-radius:10px;box-shadow:0 6px 18px rgba(2,6,23,.12)}
.brand strong{font-size:18px}
.nav a{padding:10px 12px;border-radius:10px}
.nav a.active, .btn{background:linear-gradient(90deg,var(--brand1),var(--brand2));color:#fff}
.btn{display:inline-block;padding:10px 14px;border-radius:12px;font-weight:800}
.card{background:#fff;border:1px solid #e2e8f0;border-radius:16px;box-shadow:0 10px 25px rgba(2,6,23,.06);padding:18px}
.grid{display:grid;gap:16px} .grid-2{grid-template-columns:repeat(2,1fr)} .grid-3{grid-template-columns:repeat(3,1fr)}
@media(max-width:900px){ .grid-2,.grid-3{grid-template-columns:1fr} }
footer{padding:24px 20px;color:#64748b;text-align:center;border-top:1px solid #e2e8f0;margin-top:40px}
</style>
</head>
<body>
<header><div class="container">
  <nav>
    <div class="brand">
      <img src="logo.png" alt="FactuPro logo">
      <strong>FactuPro</strong>
    </div>
    <div class="nav">
      <a href="index.html">Accueil</a>
      <a href="factures.html">Factures</a>
      <a href="abonnements.html">Abonnements</a>
      <a href="parametres.html">Param√®tres</a>
    </div>
  </nav>
</div></header>
<div class="container">

<div class="card">
  <h1>üßæ Devis & Factures</h1>
  <div class="grid grid-2">
    <div>
      <label>Type</label><br><select id="docType"><option value="devis">Devis</option><option value="facture">Facture</option></select><br><br>
      <label>N¬∞</label><br><input id="docNo" placeholder="2025-00001"><br><br>
      <label>Date</label><br><input id="docDate" type="date"><br><br>
      <label>Client</label><br><input id="client"><br><br>
      <label>Adresse</label><br><textarea id="addr" rows="3"></textarea>
    </div>
    <div>
      <label>TVA par d√©faut (%)</label><br><input id="vatDefault" type="number" value="20" step="0.1"><br><br>
      <label>Objet</label><br><input id="title" placeholder="Travaux ‚Äî Dalle b√©ton"><br><br>
      <label>Acompte (‚Ç¨)</label><br><input id="deposit" type="number" value="0" step="0.01"><br><br>
      <label>Notes</label><br><textarea id="notes" rows="3" placeholder="R√®glement 30j."></textarea>
    </div>
  </div>
  <h3>üß∞ Lignes</h3>
  <div style="overflow-x:auto">
  <table id="lines" style="width:100%;border-collapse:collapse">
    <thead><tr><th style="text-align:left;border-bottom:1px solid #e2e8f0;padding:8px">D√©signation</th>
    <th class="right" style="border-bottom:1px solid #e2e8f0;padding:8px">Qt√©</th>
    <th class="right" style="border-bottom:1px solid #e2e8f0;padding:8px">PU HT</th>
    <th class="right" style="border-bottom:1px solid #e2e8f0;padding:8px">TVA %</th>
    <th class="right" style="border-bottom:1px solid #e2e8f0;padding:8px">Remise</th>
    <th class="right" style="border-bottom:1px solid #e2e8f0;padding:8px">Total HT</th>
    <th></th></tr></thead>
    <tbody></tbody>
    <tfoot>
      <tr><td colspan="5" style="text-align:right;padding:8px">Sous‚Äëtotal HT</td><td class="right" id="sum_ht" style="padding:8px;font-weight:800">0,00 ‚Ç¨</td><td></td></tr>
      <tr><td colspan="5" style="text-align:right;padding:8px">Total TVA</td><td class="right" id="sum_vat" style="padding:8px;font-weight:800">0,00 ‚Ç¨</td><td></td></tr>
      <tr><td colspan="5" style="text-align:right;padding:8px">Total TTC</td><td class="right" id="sum_ttc" style="padding:8px;font-weight:800">0,00 ‚Ç¨</td><td></td></tr>
    </tfoot>
  </table></div>
  <p style="text-align:right;margin-top:10px">
    <a class="btn" id="add">+ Ajouter une ligne</a>
    <a class="btn" onclick="window.print()">üñ®Ô∏è Imprimer / PDF</a>
    <a class="btn" onclick="save()">üíæ Enregistrer</a>
  </p>
</div>
<script>
const $=s=>document.querySelector(s);
function today(){const d=new Date();return new Date(d.getTime()-d.getTimezoneOffset()*60000).toISOString().slice(0,10)}
$('#docDate').value=today();
function fmt(n){return (Number(n)||0).toLocaleString('fr-FR',{minimumFractionDigits:2,maximumFractionDigits:2})+' ‚Ç¨'}
function addRow(line={{desc:'Prestation',qty:1,price:50,vat:parseFloat($('#vatDefault').value||'20'),discount:0}}){{
  const tr=document.createElement('tr');
  tr.innerHTML=`<td style="padding:8px;border-bottom:1px solid #e2e8f0"><input class="desc" style="width:100%;padding:8px"></td>
  <td class="right" style="padding:8px;border-bottom:1px solid #e2e8f0"><input class="qty" type="number" step="0.01" value="${line.qty}" style="width:100%;padding:8px"></td>
  <td class="right" style="padding:8px;border-bottom:1px solid #e2e8f0"><input class="price" type="number" step="0.01" value="${line.price}" style="width:100%;padding:8px"></td>
  <td class="right" style="padding:8px;border-bottom:1px solid #e2e8f0"><input class="vat" type="number" step="0.1" value="${line.vat}" style="width:100%;padding:8px"></td>
  <td class="right" style="padding:8px;border-bottom:1px solid #e2e8f0"><input class="discount" type="number" step="0.01" value="${line.discount}" style="width:100%;padding:8px"></td>
  <td class="right" style="padding:8px;border-bottom:1px solid #e2e8f0"><span class="total">0,00 ‚Ç¨</span></td>
  <td class="right" style="padding:8px;border-bottom:1px solid #e2e8f0"><button class="btn del" style="background:#e11d48">x</button></td>`;
  document.querySelector('#lines tbody').appendChild(tr);
  tr.querySelectorAll('input').forEach(i=> i.addEventListener('input', calc));
  tr.querySelector('.del').addEventListener('click', ()=>{{tr.remove(); calc();}});
  calc();
}}
document.getElementById('add').addEventListener('click', ()=> addRow());
function calc(){{
  let sHT=0,sVAT=0;
  document.querySelectorAll('#lines tbody tr').forEach(tr=>{{
    const g=cls=>parseFloat(tr.querySelector('.'+cls).value||'0');
    const qty=g('qty'), price=g('price'), vat=g('vat'), discount=g('discount');
    const ht=Math.max(0, qty*price-discount); sHT+=ht; sVAT+=ht*vat/100;
    tr.querySelector('.total').textContent=fmt(ht);
  }});
  document.getElementById('sum_ht').textContent=fmt(sHT);
  document.getElementById('sum_vat').textContent=fmt(sVAT);
  const deposit=parseFloat(document.getElementById('deposit').value||'0');
  document.getElementById('sum_ttc').textContent=fmt(Math.max(0,sHT+sVAT-deposit));
}}
['vatDefault','deposit','title','client','addr','notes','docNo','docType'].forEach(id=>{{
  const el=document.getElementById(id); if(el) el.addEventListener('input', calc);
}});
addRow();
function save(){{
  const data={{type:$('#docType').value,no:$('#docNo').value,date:$('#docDate').value,title:$('#title').value,client:$('#client').value,addr:$('#addr').value,
  vatDefault:$('#vatDefault').value,deposit:$('#deposit').value,notes:$('#notes').value,
  lines:[...document.querySelectorAll('#lines tbody tr')].map(tr=>({{
    desc:tr.querySelector('.desc').value, qty:parseFloat(tr.querySelector('.qty').value||'0'),
    price:parseFloat(tr.querySelector('.price').value||'0'), vat:parseFloat(tr.querySelector('.vat').value||'0'),
    discount:parseFloat(tr.querySelector('.discount').value||'0')
  }}))}};
  const list=JSON.parse(localStorage.getItem('fp.docs')||'[]'); list.unshift(data);
  localStorage.setItem('fp.docs', JSON.stringify(list));
  alert('Document enregistr√© dans le navigateur.');
}}
</script>
</div>
<footer>¬© <span id="y"></span> FactuPro</footer>
<script>document.getElementById('y').textContent=new Date().getFullYear()</script>
</body></html>